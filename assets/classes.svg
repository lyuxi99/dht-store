<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1154px" preserveAspectRatio="none" style="width:1575px;height:1154px;background:#FFFFFF;" version="1.1" viewBox="0 0 1575 1154" width="1575px" zoomAndPan="magnify"><defs/><g><rect height="26.2969" id="_title" style="stroke:#00000000;stroke-width:1.0;fill:none;" width="126" x="717.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="116" x="722.5" y="22.9951">Class Diagram</text><!--MD5=[c60af77fe5573b84a4aa4bce89659574]
class Server--><g id="elem_Server"><rect codeLine="6" fill="#F1F1F1" height="80.5938" id="Server" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="111" x="1253.5" y="44.2969"/><ellipse cx="1282.9" cy="60.2969" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1285.2438,55.9688 C1284.3063,55.5313 1283.7125,55.3906 1282.8375,55.3906 C1280.2125,55.3906 1278.2125,57.4688 1278.2125,60.1875 L1278.2125,61.3125 C1278.2125,63.8906 1280.3219,65.7813 1283.2125,65.7813 C1284.4313,65.7813 1285.5875,65.4844 1286.3375,64.9375 C1286.9156,64.5313 1287.2438,64.0781 1287.2438,63.6875 C1287.2438,63.2344 1286.8531,62.8438 1286.3844,62.8438 C1286.1656,62.8438 1285.9625,62.9219 1285.775,63.1094 C1285.3219,63.5938 1285.3219,63.5938 1285.1344,63.6875 C1284.7125,63.9531 1284.025,64.0781 1283.2594,64.0781 C1281.2125,64.0781 1279.9156,62.9844 1279.9156,61.2813 L1279.9156,60.1875 C1279.9156,58.4063 1281.1656,57.0938 1282.9,57.0938 C1283.4781,57.0938 1284.0875,57.25 1284.5563,57.5 C1285.0406,57.7813 1285.2125,58 1285.3063,58.4063 C1285.3688,58.8125 1285.4,58.9375 1285.5406,59.0625 C1285.6813,59.2031 1285.9156,59.3125 1286.1344,59.3125 C1286.4,59.3125 1286.6656,59.1719 1286.8375,58.9531 C1286.9469,58.7969 1286.9781,58.6094 1286.9781,58.1875 L1286.9781,56.7656 C1286.9781,56.3281 1286.9625,56.2031 1286.8688,56.0469 C1286.7125,55.7813 1286.4313,55.6406 1286.1344,55.6406 C1285.8375,55.6406 1285.6344,55.7344 1285.4156,56.0469 L1285.2438,55.9688 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1300.1" y="65.1436">Server</text><line style="stroke:#181818;stroke-width:0.5;" x1="1254.5" x2="1363.5" y1="76.2969" y2="76.2969"/><line style="stroke:#181818;stroke-width:0.5;" x1="1254.5" x2="1363.5" y1="84.2969" y2="84.2969"/><ellipse cx="1264.5" cy="95.2969" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="1273.5" y="101.292">void Serve()</text><ellipse cx="1264.5" cy="111.5938" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="1273.5" y="117.5889">void Stop()</text></g><!--MD5=[03b9f77d4324894200cec3e82e7fec54]
class Params--><g id="elem_Params"><rect codeLine="11" fill="#F1F1F1" height="162.0781" id="Params" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="233" x="1107.5" y="186.2969"/><ellipse cx="1193.75" cy="202.2969" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1196.0938,197.9688 C1195.1563,197.5313 1194.5625,197.3906 1193.6875,197.3906 C1191.0625,197.3906 1189.0625,199.4688 1189.0625,202.1875 L1189.0625,203.3125 C1189.0625,205.8906 1191.1719,207.7813 1194.0625,207.7813 C1195.2813,207.7813 1196.4375,207.4844 1197.1875,206.9375 C1197.7656,206.5313 1198.0938,206.0781 1198.0938,205.6875 C1198.0938,205.2344 1197.7031,204.8438 1197.2344,204.8438 C1197.0156,204.8438 1196.8125,204.9219 1196.625,205.1094 C1196.1719,205.5938 1196.1719,205.5938 1195.9844,205.6875 C1195.5625,205.9531 1194.875,206.0781 1194.1094,206.0781 C1192.0625,206.0781 1190.7656,204.9844 1190.7656,203.2813 L1190.7656,202.1875 C1190.7656,200.4063 1192.0156,199.0938 1193.75,199.0938 C1194.3281,199.0938 1194.9375,199.25 1195.4063,199.5 C1195.8906,199.7813 1196.0625,200 1196.1563,200.4063 C1196.2188,200.8125 1196.25,200.9375 1196.3906,201.0625 C1196.5313,201.2031 1196.7656,201.3125 1196.9844,201.3125 C1197.25,201.3125 1197.5156,201.1719 1197.6875,200.9531 C1197.7969,200.7969 1197.8281,200.6094 1197.8281,200.1875 L1197.8281,198.7656 C1197.8281,198.3281 1197.8125,198.2031 1197.7188,198.0469 C1197.5625,197.7813 1197.2813,197.6406 1196.9844,197.6406 C1196.6875,197.6406 1196.4844,197.7344 1196.2656,198.0469 L1196.0938,197.9688 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52" x="1214.25" y="207.1436">Params</text><line style="stroke:#181818;stroke-width:0.5;" x1="1108.5" x2="1339.5" y1="218.2969" y2="218.2969"/><ellipse cx="1118.5" cy="229.2969" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="144" x="1127.5" y="235.292">string Bootstrapper</text><ellipse cx="1118.5" cy="245.5938" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="1127.5" y="251.5889">string ApiAddress</text><ellipse cx="1118.5" cy="261.8906" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="1127.5" y="267.8857">string P2pAddress</text><ellipse cx="1118.5" cy="278.1875" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="1127.5" y="284.1826">string DataFilePath</text><ellipse cx="1118.5" cy="294.4844" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="1127.5" y="300.4795">string LogFilePath</text><ellipse cx="1118.5" cy="310.7813" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="1127.5" y="316.7764">string CACert</text><ellipse cx="1118.5" cy="327.0781" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="207" x="1127.5" y="333.0732">string ServerCert, ServerKey</text><line style="stroke:#181818;stroke-width:0.5;" x1="1108.5" x2="1339.5" y1="340.375" y2="340.375"/></g><!--MD5=[14421900c9025d42ea566e10a4eb3adc]
class ApiServer--><g id="elem_ApiServer"><rect codeLine="21" fill="#F1F1F1" height="162.0781" id="ApiServer" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="538" x="7" y="186.2969"/><ellipse cx="236.25" cy="202.2969" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M238.5938,197.9688 C237.6563,197.5313 237.0625,197.3906 236.1875,197.3906 C233.5625,197.3906 231.5625,199.4688 231.5625,202.1875 L231.5625,203.3125 C231.5625,205.8906 233.6719,207.7813 236.5625,207.7813 C237.7813,207.7813 238.9375,207.4844 239.6875,206.9375 C240.2656,206.5313 240.5938,206.0781 240.5938,205.6875 C240.5938,205.2344 240.2031,204.8438 239.7344,204.8438 C239.5156,204.8438 239.3125,204.9219 239.125,205.1094 C238.6719,205.5938 238.6719,205.5938 238.4844,205.6875 C238.0625,205.9531 237.375,206.0781 236.6094,206.0781 C234.5625,206.0781 233.2656,204.9844 233.2656,203.2813 L233.2656,202.1875 C233.2656,200.4063 234.5156,199.0938 236.25,199.0938 C236.8281,199.0938 237.4375,199.25 237.9063,199.5 C238.3906,199.7813 238.5625,200 238.6563,200.4063 C238.7188,200.8125 238.75,200.9375 238.8906,201.0625 C239.0313,201.2031 239.2656,201.3125 239.4844,201.3125 C239.75,201.3125 240.0156,201.1719 240.1875,200.9531 C240.2969,200.7969 240.3281,200.6094 240.3281,200.1875 L240.3281,198.7656 C240.3281,198.3281 240.3125,198.2031 240.2188,198.0469 C240.0625,197.7813 239.7813,197.6406 239.4844,197.6406 C239.1875,197.6406 238.9844,197.7344 238.7656,198.0469 L238.5938,197.9688 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="256.75" y="207.1436">ApiServer</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="544" y1="218.2969" y2="218.2969"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="226.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="27" y="235.292">net.Listener l</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="242.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="27" y="251.5889">bool stopped</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="544" y1="258.8906" y2="258.8906"/><ellipse cx="18" cy="269.8906" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="27" y="275.8857">error Serve()</text><ellipse cx="18" cy="286.1875" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="27" y="292.1826">void Stop()</text><ellipse cx="18" cy="302.4844" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="512" x="27" y="308.4795">(MsgType, []byte) ProcessMessage(msgType MsgType, msgBody []byte)</text><ellipse cx="18" cy="318.7813" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="437" x="27" y="324.7764">void Put(key []byte, value []byte, ttl uint16, replication uint8)</text><ellipse cx="18" cy="335.0781" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="209" x="27" y="341.0732">([]byte, bool) Get(key []byte)</text></g><!--MD5=[ad510ca42d1a057b37ac2813b8ee5b40]
class Connection--><g id="elem_Connection"><rect codeLine="30" fill="#F1F1F1" height="162.0781" id="Connection" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="435" x="637.5" y="186.2969"/><ellipse cx="809.25" cy="202.2969" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M811.5938,197.9688 C810.6563,197.5313 810.0625,197.3906 809.1875,197.3906 C806.5625,197.3906 804.5625,199.4688 804.5625,202.1875 L804.5625,203.3125 C804.5625,205.8906 806.6719,207.7813 809.5625,207.7813 C810.7813,207.7813 811.9375,207.4844 812.6875,206.9375 C813.2656,206.5313 813.5938,206.0781 813.5938,205.6875 C813.5938,205.2344 813.2031,204.8438 812.7344,204.8438 C812.5156,204.8438 812.3125,204.9219 812.125,205.1094 C811.6719,205.5938 811.6719,205.5938 811.4844,205.6875 C811.0625,205.9531 810.375,206.0781 809.6094,206.0781 C807.5625,206.0781 806.2656,204.9844 806.2656,203.2813 L806.2656,202.1875 C806.2656,200.4063 807.5156,199.0938 809.25,199.0938 C809.8281,199.0938 810.4375,199.25 810.9063,199.5 C811.3906,199.7813 811.5625,200 811.6563,200.4063 C811.7188,200.8125 811.75,200.9375 811.8906,201.0625 C812.0313,201.2031 812.2656,201.3125 812.4844,201.3125 C812.75,201.3125 813.0156,201.1719 813.1875,200.9531 C813.2969,200.7969 813.3281,200.6094 813.3281,200.1875 L813.3281,198.7656 C813.3281,198.3281 813.3125,198.2031 813.2188,198.0469 C813.0625,197.7813 812.7813,197.6406 812.4844,197.6406 C812.1875,197.6406 811.9844,197.7344 811.7656,198.0469 L811.5938,197.9688 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="829.75" y="207.1436">Connection</text><line style="stroke:#181818;stroke-width:0.5;" x1="638.5" x2="1071.5" y1="218.2969" y2="218.2969"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="645.5" y="226.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="657.5" y="235.292">net.Conn conn</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="645.5" y="242.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="144" x="657.5" y="251.5889">bufio.Reader reader</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="645.5" y="258.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="153" x="657.5" y="267.8857">sync.Mutex sendLock</text><line style="stroke:#181818;stroke-width:0.5;" x1="638.5" x2="1071.5" y1="275.1875" y2="275.1875"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="645.5" y="283.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="177" x="657.5" y="292.1826">void threadReceiveMsg()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="645.5" y="299.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="409" x="657.5" y="308.4795">void handleMessage(msgType MsgType, msgBody []byte)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="645.5" y="315.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="233" x="657.5" y="324.7764">(MsgType, []byte) readMessage()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="645.5" y="332.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="401" x="657.5" y="341.0732">error sendMessage(msgType MsgType, msgBody []byte)</text></g><!--MD5=[aef01397db27474caf7629617eee836c]
class P2pServer--><g id="elem_P2pServer"><rect codeLine="39" fill="#F1F1F1" height="145.7813" id="P2pServer" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="261" x="1002.5" y="409.2969"/><ellipse cx="1091.75" cy="425.2969" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1094.0938,420.9688 C1093.1563,420.5313 1092.5625,420.3906 1091.6875,420.3906 C1089.0625,420.3906 1087.0625,422.4688 1087.0625,425.1875 L1087.0625,426.3125 C1087.0625,428.8906 1089.1719,430.7813 1092.0625,430.7813 C1093.2813,430.7813 1094.4375,430.4844 1095.1875,429.9375 C1095.7656,429.5313 1096.0938,429.0781 1096.0938,428.6875 C1096.0938,428.2344 1095.7031,427.8438 1095.2344,427.8438 C1095.0156,427.8438 1094.8125,427.9219 1094.625,428.1094 C1094.1719,428.5938 1094.1719,428.5938 1093.9844,428.6875 C1093.5625,428.9531 1092.875,429.0781 1092.1094,429.0781 C1090.0625,429.0781 1088.7656,427.9844 1088.7656,426.2813 L1088.7656,425.1875 C1088.7656,423.4063 1090.0156,422.0938 1091.75,422.0938 C1092.3281,422.0938 1092.9375,422.25 1093.4063,422.5 C1093.8906,422.7813 1094.0625,423 1094.1563,423.4063 C1094.2188,423.8125 1094.25,423.9375 1094.3906,424.0625 C1094.5313,424.2031 1094.7656,424.3125 1094.9844,424.3125 C1095.25,424.3125 1095.5156,424.1719 1095.6875,423.9531 C1095.7969,423.7969 1095.8281,423.6094 1095.8281,423.1875 L1095.8281,421.7656 C1095.8281,421.3281 1095.8125,421.2031 1095.7188,421.0469 C1095.5625,420.7813 1095.2813,420.6406 1094.9844,420.6406 C1094.6875,420.6406 1094.4844,420.7344 1094.2656,421.0469 L1094.0938,420.9688 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="1112.25" y="430.1436">P2pServer</text><line style="stroke:#181818;stroke-width:0.5;" x1="1003.5" x2="1262.5" y1="441.2969" y2="441.2969"/><ellipse cx="1013.5" cy="452.2969" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="177" x="1022.5" y="458.292">*grpc.Server RpcService</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1010.5" y="465.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="1022.5" y="474.5889">net.Listener lis</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1010.5" y="481.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="1022.5" y="490.8857">bool stopped</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1010.5" y="498.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="1022.5" y="507.1826">sync.WaitGroup wg</text><line style="stroke:#181818;stroke-width:0.5;" x1="1003.5" x2="1262.5" y1="514.4844" y2="514.4844"/><ellipse cx="1013.5" cy="525.4844" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="235" x="1022.5" y="531.4795">error Serve(bootstrapper string)</text><ellipse cx="1013.5" cy="541.7813" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="1022.5" y="547.7764">void Stop()</text></g><!--MD5=[f6a81fdb821d4e7a0c116773b11f9a84]
class ChordRpcServer--><g id="elem_ChordRpcServer"><rect codeLine="47" fill="#F1F1F1" height="341.3438" id="ChordRpcServer" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="557" x="854.5" y="616.2969"/><ellipse cx="1069.75" cy="632.2969" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1072.0938,627.9688 C1071.1563,627.5313 1070.5625,627.3906 1069.6875,627.3906 C1067.0625,627.3906 1065.0625,629.4688 1065.0625,632.1875 L1065.0625,633.3125 C1065.0625,635.8906 1067.1719,637.7813 1070.0625,637.7813 C1071.2813,637.7813 1072.4375,637.4844 1073.1875,636.9375 C1073.7656,636.5313 1074.0938,636.0781 1074.0938,635.6875 C1074.0938,635.2344 1073.7031,634.8438 1073.2344,634.8438 C1073.0156,634.8438 1072.8125,634.9219 1072.625,635.1094 C1072.1719,635.5938 1072.1719,635.5938 1071.9844,635.6875 C1071.5625,635.9531 1070.875,636.0781 1070.1094,636.0781 C1068.0625,636.0781 1066.7656,634.9844 1066.7656,633.2813 L1066.7656,632.1875 C1066.7656,630.4063 1068.0156,629.0938 1069.75,629.0938 C1070.3281,629.0938 1070.9375,629.25 1071.4063,629.5 C1071.8906,629.7813 1072.0625,630 1072.1563,630.4063 C1072.2188,630.8125 1072.25,630.9375 1072.3906,631.0625 C1072.5313,631.2031 1072.7656,631.3125 1072.9844,631.3125 C1073.25,631.3125 1073.5156,631.1719 1073.6875,630.9531 C1073.7969,630.7969 1073.8281,630.6094 1073.8281,630.1875 L1073.8281,628.7656 C1073.8281,628.3281 1073.8125,628.2031 1073.7188,628.0469 C1073.5625,627.7813 1073.2813,627.6406 1072.9844,627.6406 C1072.6875,627.6406 1072.4844,627.7344 1072.2656,628.0469 L1072.0938,627.9688 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118" x="1090.25" y="637.1436">ChordRpcServer</text><line style="stroke:#181818;stroke-width:0.5;" x1="855.5" x2="1410.5" y1="648.2969" y2="648.2969"/><ellipse cx="865.5" cy="659.2969" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="874.5" y="665.292">*Node Self</text><ellipse cx="865.5" cy="675.5938" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="874.5" y="681.5889">[]*Node Finger</text><ellipse cx="865.5" cy="691.8906" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="874.5" y="697.8857">*Node Predecessor</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="862.5" y="705.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="153" x="874.5" y="714.1826">[]*Node successorList</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="862.5" y="721.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131" x="874.5" y="730.4795">sync.Mutex mutex</text><line style="stroke:#181818;stroke-width:0.5;" x1="855.5" x2="1410.5" y1="737.7813" y2="737.7813"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="862.5" y="745.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="874.5" y="754.7764">*Node successor()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="862.5" y="762.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="287" x="874.5" y="771.0732">*Node closestPrecedingFinger(id []byte)</text><ellipse cx="865.5" cy="781.375" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="498" x="874.5" y="787.3701">(*proto.Node, error) FindSuccessor(ctx context.Context, id *proto.Id)</text><ellipse cx="865.5" cy="797.6719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="531" x="874.5" y="803.667">(*proto.Node, error) GetPredecessor(ctx context.Context, in *proto.Void)</text><ellipse cx="865.5" cy="813.9688" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="378" x="874.5" y="819.9639">error Join(ctx context.Context, bootstrapper *Node)</text><ellipse cx="865.5" cy="830.2656" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="430" x="874.5" y="836.2607">error CheckPredecessorAndSuccessor(ctx context.Context)</text><ellipse cx="865.5" cy="846.5625" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="261" x="874.5" y="852.5576">error Stabilize(ctx context.Context)</text><ellipse cx="865.5" cy="862.8594" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="530" x="874.5" y="868.8545">(*proto.SuccessorList, error) Notify(ctx context.Context, nn *proto.Node)</text><ellipse cx="865.5" cy="879.1563" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="270" x="874.5" y="885.1514">error FixFingers(ctx context.Context)</text><ellipse cx="865.5" cy="895.4531" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="442" x="874.5" y="901.4482">(*proto.Void, error) Ping(ctx context.Context, in *proto.Void)</text><ellipse cx="865.5" cy="911.75" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="466" x="874.5" y="917.7451">(*proto.Void, error) Put(ctx context.Context, req *proto.PutReq)</text><ellipse cx="865.5" cy="928.0469" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="503" x="874.5" y="934.042">(*proto.GetResp, error) Get(ctx context.Context, req *proto.GetReq)</text><ellipse cx="865.5" cy="944.3438" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="155" x="874.5" y="950.3389">string GetInfoString()</text></g><!--MD5=[11b747870319a085bc745183e08c5f76]
class Storage--><g id="elem_Storage"><rect codeLine="69" fill="#F1F1F1" height="129.4844" id="Storage" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="392" x="1176" y="1018.2969"/><ellipse cx="1339.25" cy="1034.2969" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1341.5938,1029.9688 C1340.6563,1029.5313 1340.0625,1029.3906 1339.1875,1029.3906 C1336.5625,1029.3906 1334.5625,1031.4688 1334.5625,1034.1875 L1334.5625,1035.3125 C1334.5625,1037.8906 1336.6719,1039.7813 1339.5625,1039.7813 C1340.7813,1039.7813 1341.9375,1039.4844 1342.6875,1038.9375 C1343.2656,1038.5313 1343.5938,1038.0781 1343.5938,1037.6875 C1343.5938,1037.2344 1343.2031,1036.8438 1342.7344,1036.8438 C1342.5156,1036.8438 1342.3125,1036.9219 1342.125,1037.1094 C1341.6719,1037.5938 1341.6719,1037.5938 1341.4844,1037.6875 C1341.0625,1037.9531 1340.375,1038.0781 1339.6094,1038.0781 C1337.5625,1038.0781 1336.2656,1036.9844 1336.2656,1035.2813 L1336.2656,1034.1875 C1336.2656,1032.4063 1337.5156,1031.0938 1339.25,1031.0938 C1339.8281,1031.0938 1340.4375,1031.25 1340.9063,1031.5 C1341.3906,1031.7813 1341.5625,1032 1341.6563,1032.4063 C1341.7188,1032.8125 1341.75,1032.9375 1341.8906,1033.0625 C1342.0313,1033.2031 1342.2656,1033.3125 1342.4844,1033.3125 C1342.75,1033.3125 1343.0156,1033.1719 1343.1875,1032.9531 C1343.2969,1032.7969 1343.3281,1032.6094 1343.3281,1032.1875 L1343.3281,1030.7656 C1343.3281,1030.3281 1343.3125,1030.2031 1343.2188,1030.0469 C1343.0625,1029.7813 1342.7813,1029.6406 1342.4844,1029.6406 C1342.1875,1029.6406 1341.9844,1029.7344 1341.7656,1030.0469 L1341.5938,1029.9688 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="1359.75" y="1039.1436">Storage</text><line style="stroke:#181818;stroke-width:0.5;" x1="1177" x2="1567" y1="1050.2969" y2="1050.2969"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1184" y="1058.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="1196" y="1067.292">*buntdb.DB db</text><line style="stroke:#181818;stroke-width:0.5;" x1="1177" x2="1567" y1="1074.5938" y2="1074.5938"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1184" y="1082.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="230" x="1196" y="1091.5889">string encodeBytes(data []byte)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1184" y="1098.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="205" x="1196" y="1107.8857">[]byte decodeBytes(s string)</text><ellipse cx="1187" cy="1118.1875" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="366" x="1196" y="1124.1826">void Put(key []byte, value []byte, ttl time.Duration)</text><ellipse cx="1187" cy="1134.4844" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="209" x="1196" y="1140.4795">([]byte, bool) Get(key []byte)</text></g><!--MD5=[39e864dbccc78d9a3da5ecfd4e44397b]
reverse link Server to Params--><g id="link_Server_Params"><path codeLine="77" d="M1284.8,137.1769 C1277.63,152.4039 1269.61,169.4489 1261.79,186.0389 " fill="none" id="Server-backto-Params" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1290.35,125.4069,1284.1733,129.1283,1285.2328,136.2611,1291.4095,132.5397,1290.35,125.4069" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[9f030c1b3c6cca2ed8dfe7d8c208747f]
reverse link Server to ApiServer--><g id="link_Server_ApiServer"><path codeLine="78" d="M1240.37,93.8769 C1116.11,108.9269 845.777,143.6569 620,186.2969 C595.598,190.9059 570.308,196.0579 545.021,201.4679 " fill="none" id="Server-backto-ApiServer" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1253.37,92.3069,1246.9379,89.0469,1241.4547,93.7304,1247.8869,96.9904,1253.37,92.3069" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[e1628f5d0579a11c78318b617401c6b3]
reverse link Server to P2pServer--><g id="link_Server_P2pServer"><path codeLine="79" d="M1337.82,137.1069 C1364.81,192.6289 1395.78,282.0829 1358,348.2969 C1336.81,385.4439 1300.72,413.2659 1263.58,433.5939 " fill="none" id="Server-backto-P2pServer" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1331.97,125.4569,1331.0861,132.6136,1337.3524,136.1821,1338.2363,129.0253,1331.97,125.4569" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[32127891360d89e282c3ed402311cf63]
reverse link Server to Storage--><g id="link_Server_Storage"><path codeLine="80" d="M1375.53,127.2769 C1417.95,159.3579 1465,208.0679 1465,266.2969 C1465,266.2969 1465,266.2969 1465,787.7969 C1465,870.2399 1431.35,959.8859 1404.53,1018.2339 " fill="none" id="Server-backto-Storage" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1364.88,119.4769,1367.3546,126.2501,1374.5585,126.571,1372.084,119.7977,1364.88,119.4769" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[cc74bf8a612cdd3ce35a6a7bc5e5e8b6]
reverse link ApiServer to P2pServer--><g id="link_ApiServer_P2pServer"><path codeLine="81" d="M558.124,338.4159 C707.86,375.6319 884.7,419.5839 1002.315,448.8159 " fill="none" id="ApiServer-backto-P2pServer" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="545.102,335.1799,549.96,340.5091,556.7477,338.0745,551.8897,332.7453,545.102,335.1799" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[9f0943df3eceab63cdf848ac45912580]
link ApiServer to Connection--><g id="link_ApiServer_Connection"><path codeLine="82" d="M545.159,267.2969 C576.02,267.2969 607.19,267.2969 637.259,267.2969 " fill="none" id="ApiServer-Connection" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#000000" points="572.25,255.8633,563.2049,252.9244,563.2049,258.8022,572.25,255.8633" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="576.25" y="260.3638">Create</text></g><!--MD5=[2210bb75ca3f249134d704292677cae7]
reverse link P2pServer to ChordRpcServer--><g id="link_P2pServer_ChordRpcServer"><path codeLine="83" d="M1133,568.7999 C1133,583.7749 1133,599.8189 1133,616.1529 " fill="none" id="P2pServer-backto-ChordRpcServer" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1133,555.3689,1129,561.3689,1133,567.3689,1137,561.3689,1133,555.3689" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1fc879b9141963163c0ee954b9df277b]
reverse link ChordRpcServer to Storage--><g id="link_ChordRpcServer_Storage"><path codeLine="84" d="M1279.55,968.0689 C1293.99,985.8289 1307.87,1002.9059 1320.29,1018.1869 " fill="none" id="ChordRpcServer-backto-Storage" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1270.99,957.5409,1271.6714,964.7197,1278.5601,966.8518,1277.8787,959.673,1270.99,957.5409" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2e6b37095dee52c732c373ab4aa0d37f]
@startuml
'https://www.planttext.com/

title Class Diagram


class Server {
    +void Serve()
    +void Stop()
}

class Params{
    +string Bootstrapper
    +string ApiAddress
    +string P2pAddress
    +string DataFilePath
    +string LogFilePath
    +string CACert
    +string ServerCert, ServerKey
}

class ApiServer{
    -net.Listener l
    -bool stopped
    +error Serve()
    +void Stop()
    +(MsgType, []byte) ProcessMessage(msgType MsgType, msgBody []byte)
    +void Put(key []byte, value []byte, ttl uint16, replication uint8)
    +([]byte, bool) Get(key []byte)
}
class Connection{
    -net.Conn conn
    -bufio.Reader reader
    -sync.Mutex sendLock
    -void threadReceiveMsg()
    -void handleMessage(msgType MsgType, msgBody []byte)
    -(MsgType, []byte) readMessage()
    -error sendMessage(msgType MsgType, msgBody []byte)
}
class P2pServer{
    +*grpc.Server RpcService
    -net.Listener lis
    -bool stopped
    -sync.WaitGroup wg
    +error Serve(bootstrapper string)
    +void Stop()
}
class ChordRpcServer{
	+*Node Self
	+[]*Node Finger
	+*Node Predecessor
	-[]*Node successorList
	-sync.Mutex mutex

    -*Node successor()
	-*Node closestPrecedingFinger(id []byte)
    +(*proto.Node, error) FindSuccessor(ctx context.Context, id *proto.Id)
    +(*proto.Node, error) GetPredecessor(ctx context.Context, in *proto.Void)
    +error Join(ctx context.Context, bootstrapper *Node)
    +error CheckPredecessorAndSuccessor(ctx context.Context)
    +error Stabilize(ctx context.Context)
    +(*proto.SuccessorList, error) Notify(ctx context.Context, nn *proto.Node)
    +error FixFingers(ctx context.Context)
    +(*proto.Void, error) Ping(ctx context.Context, in *proto.Void)
    +(*proto.Void, error) Put(ctx context.Context, req *proto.PutReq)
    +(*proto.GetResp, error) Get(ctx context.Context, req *proto.GetReq)
    +string GetInfoString()

}
class Storage{
    -*buntdb.DB db
    -string encodeBytes(data []byte)
    -[]byte decodeBytes(s string)
    +void Put(key []byte, value []byte, ttl time.Duration)
    +([]byte, bool) Get(key []byte)
}

Server *- - Params
Server *- - ApiServer
Server *- - P2pServer
Server *- - Storage
ApiServer *- - P2pServer
ApiServer - Connection : Create >
P2pServer *- - ChordRpcServer
ChordRpcServer *- - Storage
@enduml

@startuml

title Class Diagram


class Server {
    +void Serve()
    +void Stop()
}

class Params{
    +string Bootstrapper
    +string ApiAddress
    +string P2pAddress
    +string DataFilePath
    +string LogFilePath
    +string CACert
    +string ServerCert, ServerKey
}

class ApiServer{
    -net.Listener l
    -bool stopped
    +error Serve()
    +void Stop()
    +(MsgType, []byte) ProcessMessage(msgType MsgType, msgBody []byte)
    +void Put(key []byte, value []byte, ttl uint16, replication uint8)
    +([]byte, bool) Get(key []byte)
}
class Connection{
    -net.Conn conn
    -bufio.Reader reader
    -sync.Mutex sendLock
    -void threadReceiveMsg()
    -void handleMessage(msgType MsgType, msgBody []byte)
    -(MsgType, []byte) readMessage()
    -error sendMessage(msgType MsgType, msgBody []byte)
}
class P2pServer{
    +*grpc.Server RpcService
    -net.Listener lis
    -bool stopped
    -sync.WaitGroup wg
    +error Serve(bootstrapper string)
    +void Stop()
}
class ChordRpcServer{
	+*Node Self
	+[]*Node Finger
	+*Node Predecessor
	-[]*Node successorList
	-sync.Mutex mutex

    -*Node successor()
	-*Node closestPrecedingFinger(id []byte)
    +(*proto.Node, error) FindSuccessor(ctx context.Context, id *proto.Id)
    +(*proto.Node, error) GetPredecessor(ctx context.Context, in *proto.Void)
    +error Join(ctx context.Context, bootstrapper *Node)
    +error CheckPredecessorAndSuccessor(ctx context.Context)
    +error Stabilize(ctx context.Context)
    +(*proto.SuccessorList, error) Notify(ctx context.Context, nn *proto.Node)
    +error FixFingers(ctx context.Context)
    +(*proto.Void, error) Ping(ctx context.Context, in *proto.Void)
    +(*proto.Void, error) Put(ctx context.Context, req *proto.PutReq)
    +(*proto.GetResp, error) Get(ctx context.Context, req *proto.GetReq)
    +string GetInfoString()

}
class Storage{
    -*buntdb.DB db
    -string encodeBytes(data []byte)
    -[]byte decodeBytes(s string)
    +void Put(key []byte, value []byte, ttl time.Duration)
    +([]byte, bool) Get(key []byte)
}

Server *- - Params
Server *- - ApiServer
Server *- - P2pServer
Server *- - Storage
ApiServer *- - P2pServer
ApiServer - Connection : Create >
P2pServer *- - ChordRpcServer
ChordRpcServer *- - Storage
@enduml

PlantUML version 1.2022.7beta2(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>